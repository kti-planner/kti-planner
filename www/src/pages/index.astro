---
import { db } from '@backend/db';
import Layout from '@layouts/Layout.astro';

const { session } = Astro.locals;

session.counter ??= 0;
session.counter++;

const databaseCounter = (await db.query<{ count: number }>('SELECT Count(*) as count FROM counter')).rows[0]?.count;
---

<Layout>
    <div class="container">
        Hello World!
        <i class="bi bi-emoji-smile"></i>
        <br />
        Session counter: {session.counter}
        <br />
        Database counter: {databaseCounter}
        <br />
        <form action="/increment-counter/" method="post">
            <input type="number" name="count" class="form-control" placeholder="Count" />
            <button type="submit" class="btn btn-primary"> Increment counter </button>
        </form>
    </div>
</Layout>
